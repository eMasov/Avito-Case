# Avito-Case

## Краткое описание 

Чтобы разбивать строку на слова считал логиты для вероятностей поставить пробел на i-ой позиции. 

## Использовал 
- размечал данные на (индекс, есть пробел (да/нет - 0/1))
- использовал `score_word` с токенайзером от берта, чтобы разбивать нестандартные запросы типа `айфон14про`.
- динамическое программирование с эвристиками (потенциальные индексы разбиения - между буквой и цифрой, разными языками или регистрами)
- создавал словарь (есть в структуре)
- LSTM-модель (обучал на датасете RuBQ-2), она дает свой вклад (регулируется ALPHA)


## Структура
- `main.ipynb`: jupiter со всем кодом
- `bilstm_ru_stream_v2.pth`: Веса обученной LSTM-модели.
- `char2id_stream_v2.json`: Словарь символ-индекс

## Ресурсы
Обучал на P100, в одна эпоха занимала 2 - 2.5 минуты (у меня подтвержденный аккаунт на Kaggle).

## Что я пробовал, но не вышло:
- GRU вместо LSTM - архитектура легче, но результат был около 0.53
- Частотный словарь с DP и эвристиками - скор в районе 0.37
